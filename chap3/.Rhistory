setwd("c:/zproject/ISLR/chap3")
getwd()
pop
pop <- c('A','B','C')
pop
sample( pop, 2 )
seq( 0, 1, by=0.2 )
X1 <- 1:20
X2 <- 1:20
Y00 = 0.5*X1 + 0.7X2
Y00 <- 0.5*X1 + 0.7X2
Y00 <- 0.5*X1 + 0.7*X2
Y00
lm( Y00~X1+X2 )
Y0 <- 0.5*X1
Y0
X1
plot( X1, Y0 )
lm.Y0 <- lm( Y0~X1 )
lm.Y0
abline( lm.Y0 )
summary( lm.Y0 )
?sample
sample( 1:5, 5, replace=T )
sample( 1:5, 5, replace=T )
sample( 1:5, 5, replace=T )
sample( 1:5, 5, replace=T )
seq( -1, 1, by=0.01 )
length(Y0)
Y1 
sample( 1:20, length(Y0), replace=T )
sample( seq(-1,1,by=0.01), length(Y0), replace=T )
Y0*sample( seq(-1,1,by=0.01), length(Y0), replace=T )
Y1 <- Y0*sample( seq(-1,1,by=0.01), length(Y0), replace=T )
Y1
plot( Y0, Y1 )
Y1 <- Y0 + sample( seq(-1,1,by=0.01), length(Y0), replace=T )
plot( Y0, Y1 )
Y2 <- Y0 + 2*sample( seq(-1,1,by=0.01), length(Y0), replace=T )
plot( Y0, Y2 )
lm.Y1 <- lm( Y1~X1 )
plot( X1, Y1 )
lm.Y2 <- lm( Y2~X1 )
plot( X1, Y2 )
abline( lm.Y2 )
abline( lm.Y0 )
abline( lm.Y1, col="red" )
abline( lm.Y2, col="blue" )
summary( lm.Y1 )
summary( lm.Y2 )
Y00 <- 0.5*X1 + 0.7*X2
Y00
lm.Y00 <- lm( Y00~X1+X2 )
lm.Y00
X
X2
YY0 <- 0.5*X1^2
YY0
YY0 <- 0.5*(X1^2)
YY0
YY0 <- 0.5*X1^2 + 0.7*X1
YY0
YY00 <- 0.5*X1^2 + 0.7*X1
YY00
YY11 <- e1*0.5*X1^2 + e1*0.7*X1
e1 <- sample( seq(-1,1,by=0.01), length(YY0), replace=T )
e2 <- 2*sample( seq(-1,1,by=0.01), length(YY0), replace=T )
YY11 <- e1*0.5*X1^2 + e1*0.7*X1
lm.YY11_1 <- lm( YY11~X1 )
lm.YY11_2 <- lm( YY11~I(X1^2) )
par( mfrow=c(2,2) )
plot( lm.YY11_1 )
par( mfrow=c(2,2) )
plot( lm.YY11_2 )
lm.YY11_2 <- lm( YY11~I(X1^2)+X1 )
par( mfrow=c(2,2) )
plot( lm.YY11_2 )
summary( lm.YY11_2 )
plot( X1, YY11 )
YY11 <- 0.5*(X1^2+e1) + 0.7*(X1+e1)
lm.YY11_1 <- lm( YY11~X1 )
lm.YY11_2 <- lm( YY11~I(X1^2)+X1 )
plot( lm.YY11_1 )
par( mfrow=c(2,2) )
plot( lm.YY11_1 )
plot( YY11, X1 )
abline( lm.YY11_1 )
abline( lm.YY11_2 )
lm.YY11_1
lm.YY11_2
plot( X1, YY11 )
abline( lm.YY11_1 )
abline( lm.YY11_2 )
summary( YY11_1 )
summary( lm.YY11_1 )
summary( lm.YY11_2 )
YY22 <- 0.5*(X1^2+e2) + 0.7*(X1+e2)
lm.YY2_2 <- lm( YY22~I(X1^2)+X1 )
summary( lm.YY2_2 )
X1
X2
Y0
Y = 0.5X1 + 0.7*X2 + 1
Y = 0.5*X1 + 0.7*X2 + 1
Y0 = 0.5*X1 + 0.7*X2 + 1
lm.Y0 <- lm( Y0~X1 )
par( mfrow=c(2,2) )
plot( lm.Y0 )
plot( X1, Y0 )
Y0
abline( lm.Y0 )
plot( lm.Y0 )
plot( lm.Y0 )
par( mfrow=c(2,2) )
X2 <- X1^1.2
plot( X1, X2 )
X2 <- X1^2
plot( X1, X2 )
Y00 <- 0.5*X1 + 0.7*X2
plot( X1, Y00 )
plot( X2, Y00 )
lm.Y0_ <- lm( Y00~X1 )
summary( lm.Y0 )
summary( lm.Y0_ )
lm.Y00 <- lm( Y00~X1+X2 )
summary( lm.Y00 )
e1 <- sample( seq(-1,1,by=0.2), length(X1), replace=T )
e2 <- sample( seq(-1,1,by=0.2), length(X1), replace=T )*2
Y12 <- 0.5*(X1+e1) + 0.7*(X2+e2)
lm.Y12 <- lm(Y12~X1+X2)
summary( lm.Y12 )
vif( lm.Y12 )
library( car )
vif( lm.Y12 )
Y0
Y0 <- 0.7*X1 + 0.2
lm.Y0 <- lm( Y0~X1 )
summary( lm.Y0 )
Y1 <- 0.7*(X1+e1) + 0.2
Y2 <- 0.7*(X1+e2) + 0.2
lm.Y1 <- lm( Y1~X1 )
lm.Y2 <- lm( Y2~X1 )
summary( Y0 )
summary( lm.Y0 )
summary( lm.Y1 )
head(Boston)
library(MASS)
library(ISLR)
head(Boston)
names(Boston)
plot( Boston$medv, Boston$lstat )
plot( Boston$medv, Boston$age )
lm.lstat <- lm( medv~lstat, datat=Boston )
lm.lstat <- lm( mdev~lstat, data=Boston )
lm.stat <- lm( medv~lstat, data=Boston )
attach(Boston)
plot( lstat, medv )
abline( lm.lstat )
lm.lstat <- lm( medv~lstat )
abline( lm.lstat )
summary( lm.lstat )
lm.lstat_log <- lm( medv~log(lstat) )
abline( lm.lstat_log )
summary( lm.lstat_log )
myd <- data.frame( X1, X2, Y0 )
myd
myd$X1
plot( lstat, medv )
windows()
plot( lstat, age )
plot( lstat, medv )
points( age, medv )
points( age, medv, col="blue" )
points( lstat, medv, col="red" )
plot( X1, X2 )
lines( X1, X2 )
lm.lstat_log
plot( medv, lstat )
abline( lm.lstat )
abline( lm.lstat, col="blue" )
summary( lm.lstat_log )
lines( lm.lstat_log )
lines( -12.48*log(X1)+52.125, medv )
plot( lstat, medv )
lines( -12.48*log(X1)+52.125, medv )
lines( -12.48*log(lstat)+52.125, medv )
par( mfrow=c(2,2) )
plot( lm.lstat_log )
plot( lstat, medv )
points( log(lstat), medv )
plot( lstat, medv )
points( -12*log(lstat), medv, col="red" )
points( log(lstat), medv, col="red" )
points( 2*log(lstat), medv, col="red" )
points( 10*log(lstat), medv, col="red" )
points( 10*log(lstat), medv, col="blue" )
points( 12*log(lstat), medv, col="blue" )
points( -12*log(lstat), medv, col="blue" )
X1
Ylog0 <- 1.3*log(X1)
Ylog0
plot( X1, Ylog0 )
Ydev0 <- 0.3/X1
plot( X1, Ydev0 )
points( X1, Ylog0 )
lm.dev <- lm( medv~(1/lstat), data=Boston )
summary( lm.dev )
plot( lm.dev )
X1
1/X1
Y1 <- 0.3*(X1+e1) + 0.7
Y2 <- 0.3*(X1+e2) + 0.7
lm.Y1 <- lm( Y1~X1 )
lm.Y2 <- lm( Y1~X1 )
summary( lm.Y1 )
summary( lm.Y2 )
lm.Y2 <- lm( Y2~X1 )
summary( lm.Y2 )
q()
